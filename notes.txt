# Redmine Clone - Status Notes


## Letzte Iteration (2026-01-17)
- **UX: Issue-Suche ignoriert Leerzeichen**
  - Problem: Suche mit Fuehrungs/Trailing-Spaces oder nur Whitespace liefert unerwartete Ergebnisse
  - Loesung: `filterIssues()` trimmt Suchbegriff; Whitespace-only Suche wird ignoriert
  - Tests in `src/lib/issues.test.ts` ergaenzt
  - Dateien geaendert:
    - `src/lib/issues.ts`: Suchbegriff trimmen
    - `src/lib/issues.test.ts`: Tests fuer Trim + Whitespace
    - `plans/prd.md`: Feature dokumentiert
  - **Tests:** `npm run lint` (2 bestehende warnings zu `<img>`), `npm test -- --run`, `npm run build` (Next.js Warnung zu mehreren lockfiles + edge runtime)

  **Naechste Schritte:**
  - PRD-Task: Administration (Settings) implementieren

## Letzte Iteration (2026-01-17)
- **UX: Issue-Suche nach ID**
  - Problem: Suche ber√ºcksichtigt nur Subject/Description, Issue-ID nicht
  - L√∂sung: `filterIssues()` pr√ºft jetzt zus√§tzlich `issue.id`
  - Test erg√§nzt in `src/lib/issues.test.ts`
  - Dateien ge√§ndert:
    - `src/lib/issues.ts`: ID-Search Support
    - `src/lib/issues.test.ts`: Test f√ºr ID-Suche
    - `plans/prd.md`: Feature dokumentiert
  - **Tests:** `npm run lint` (2 bestehende warnings zu `<img>`), `npm test`, `npm run build` (Next.js Warnung zu mehreren lockfiles + edge runtime)

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Letzte Iteration (2026-01-15)
- **UX: Project-Filter f√ºr Issues-Liste**
  - Problem: Issues-Liste hatte Filter f√ºr Status, Tracker und Priority, aber keinen Project-Filter
  - User konnten nicht nach Projekt filtern, obwohl die Daten vorhanden waren
  - L√∂sung:
    - `IssueFilters.projectId` erweitert von `string` auf `string | string[]` (Multi-Select Support)
    - `filterIssues()` in `src/lib/issues.ts` aktualisiert f√ºr Array-Support
    - Neuer `FilterDropdown` f√ºr Projects in `issues-list.tsx`
    - Projekte werden automatisch aus den Issues extrahiert (keine zus√§tzliche API-Anfrage)
    - Filter nur sichtbar wenn mehr als 1 Projekt vorhanden
  - Dateien ge√§ndert:
    - `src/lib/issues.ts`: Multi-Project Filter Support
    - `src/app/(app)/issues/issues-list.tsx`: Project-Filter UI hinzugef√ºgt
  - **232 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **UX: "My Issues" Sektion auf Dashboard**
  - Problem: Dashboard zeigte nur "Recent Issues" (neueste 5), aber nicht die dem User zugewiesenen Issues
  - User mussten zur Issues-Seite navigieren und filtern, um ihre eigene Arbeit zu sehen
  - L√∂sung:
    - Dashboard l√§dt jetzt Session parallel zu Issues und Projects
    - Neue "My Issues" Sektion zeigt offene Issues, die dem User zugewiesen sind (max 5)
    - Nutzt bestehende `IssuesTable` Komponente mit eigenem Titel
    - Layout passt sich automatisch an: "My Issues" + "Recent Issues" oder nur "Recent Issues"
  - Dateien ge√§ndert:
    - `src/app/(app)/page.tsx`: Session laden, myIssues berechnen, serializeIssue Helper extrahiert
  - **232 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **UX: "Due Soon" Warnung f√ºr Issues (heute/morgen f√§llig)**
  - Problem: Issues die bald f√§llig sind (heute oder morgen) hatten keine visuelle Hervorhebung
  - √úberf√§llige Issues wurden bereits rot markiert, aber "bald f√§llig" fehlte
  - L√∂sung:
    - Neue `isDueSoon()` Funktion in `src/types/index.ts`
    - Pr√ºft ob Issue heute oder morgen f√§llig ist (nicht √ºberf√§llig, nicht completed)
    - Nutzt `completedStatuses` f√ºr Konsistenz mit `isOverdue()` und `isDueThisWeek()`
    - Amber/Orange Warnung (Clock-Icon + amber-colored text) f√ºr Due-Soon Issues
  - UI-√Ñnderungen in 3 Dateien:
    - `src/app/(app)/issues/issues-list.tsx`: Mobile + Desktop Ansicht
    - `src/components/dashboard/issues-table.tsx`: Mobile + Desktop Ansicht
    - `src/app/(app)/issues/[id]/issue-sidebar.tsx`: Issue Detail Sidebar
  - 9 neue Tests in `src/types/index.test.ts`
  - **232 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **UX: Sidebar Navigation Badge f√ºr offene Issues**
  - Problem: Sidebar Navigation zeigte keine visuelle Indikation f√ºr offene/√ºberf√§llige Issues
  - User mussten zur Issues-Seite navigieren um den aktuellen Stand zu sehen
  - L√∂sung:
    - `AppSidebar` Komponente erweitert um optionale `counts` Props (`SidebarCounts` Type)
    - Layout l√§dt Issues parallel zur Session und berechnet Counts
    - "Issues" Link zeigt jetzt Badge mit Anzahl offener Issues (new + in_progress)
    - Bei √ºberf√§lligen Issues wird Badge rot eingef√§rbt (`bg-red-500 text-white`)
    - Nutzt bestehende `SidebarMenuBadge` Komponente aus shadcn/ui
  - Dateien ge√§ndert:
    - `src/components/dashboard/app-sidebar.tsx`: SidebarCounts Type, Badge-Rendering
    - `src/app/(app)/layout.tsx`: Issues laden, Counts berechnen und √ºbergeben
  - **223 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **Security/UX: Attachment Delete Ownership Check**
  - Problem 1: `deleteAttachment` Server Action erlaubte JEDEM eingeloggten User das L√∂schen jedes Attachments
  - Problem 2: Delete-Button war f√ºr alle User sichtbar, nicht nur f√ºr Autor/Admin
  - Das war inkonsistent mit `deleteComment`, das bereits einen Ownership-Check hatte
  - L√∂sung:
    - Server Action: Ownership-Check hinzugef√ºgt (analog zu `deleteComment`)
      - User kann nur eigene Attachments l√∂schen ODER
      - User ist Admin
    - UI: Delete-Button nur noch f√ºr Autor oder Admins sichtbar
      - `useSession()` Hook importiert f√ºr `isAdmin` Check
      - Bedingung ge√§ndert von `currentUserId && ...` zu `(currentUserId === attachment.author.id || isAdmin) && ...`
  - Dateien ge√§ndert:
    - `src/app/actions/attachments.ts`: Ownership-Check in `deleteAttachment()`
    - `src/app/(app)/issues/[id]/issue-detail.tsx`: UI-Visibility basierend auf Ownership
  - **223 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **UX: Accessibility und Empty-State Verbesserungen**
  - Problem 1: Delete-Button in User-Liste hatte kein `aria-label` f√ºr Screen Reader
  - Problem 2: Leere Listen zeigten "No X found" + "Clear filters" Button, aber User verstanden nicht, warum keine Ergebnisse angezeigt wurden
  - L√∂sung:
    - `aria-label="Delete user"` zum Delete-Button in `users-list.tsx` hinzugef√ºgt
    - Erkl√§render Hinweis "Try adjusting your filters or search term" in 3 Dateien (konsistentes Pattern)
  - Bugfix: Issues-Liste zeigte Hinweis nicht wenn nur Suche aktiv war (jetzt behoben)
  - **223 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **UX: "Overdue" Filter und Dashboard-Anzeige hinzugef√ºgt**
  - Problem: Dashboard zeigte nur "Due This Week", aber keine explizite "Overdue" Warnung
  - √úberf√§llige Issues sind kritischer und verdienen prominente Anzeige
  - L√∂sung:
    - Neuer URL-Parameter `due=overdue` f√ºr Issues-Seite
    - `DueFilter` Type erweitert: `'this_week' | 'overdue' | undefined`
    - Filter-Logik nutzt bestehende `isOverdue()` Funktion
    - Roter "Overdue" Badge mit X-Button in Issues-Liste
    - Dashboard: "Overdue" StatCard ersetzt "Open Issues" wenn √ºberf√§llige Issues existieren
    - `variant="danger"` f√ºr rote Hervorhebung mit AlertOctagon Icon
  - Dateien ge√§ndert:
    - `src/app/(app)/issues/page.tsx`: `due=overdue` Parameter Support
    - `src/app/(app)/issues/issues-list.tsx`: DueFilter erweitert, Badge hinzugef√ºgt
    - `src/app/(app)/page.tsx`: Bedingte "Overdue" StatCard
  - **223 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **UX: "Due This Week" Filter f√ºr Issues-Liste implementiert**
  - Problem: Dashboard StatCard "Due This Week" zeigte korrekte Anzahl (z.B. "2"), aber der Link f√ºhrte nur zu `/issues` ohne Filter
  - User klickte auf "Due This Week: 2" und sah alle 5 offenen Issues statt nur die 2 f√§lligen
  - L√∂sung:
    - Neue zentrale `isDueThisWeek()` Funktion in `src/types/index.ts` (analog zu `isOverdue()`)
    - Nutzt `completedStatuses` - schlie√üt resolved/closed/rejected Issues aus (konsistent mit Dashboard)
    - Neuer URL-Parameter `due=this_week` f√ºr Issues-Seite
    - `src/app/(app)/issues/page.tsx`: Akzeptiert `due` Parameter
    - `src/app/(app)/issues/issues-list.tsx`: Neuer `dueFilter` State, nutzt `isDueThisWeek()`
    - `src/app/(app)/page.tsx`: Dashboard nutzt jetzt `isDueThisWeek()` (DRY)
    - Visueller Badge "Due This Week" mit X-Button zum Entfernen des Filters
    - Dashboard StatCard Link aktualisiert: `/issues` ‚Üí `/issues?due=this_week`
  - Generisches Design: `due` Parameter erlaubt zuk√ºnftige Erweiterungen (z.B. `due=overdue`, `due=today`)
  - 10 neue Tests f√ºr `isDueThisWeek()` in `src/types/index.test.ts`
  - **223 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **UX: Technische User-ID aus Admin Users-Tabelle entfernt**
  - Problem: In der User-Verwaltung wurde unter jedem Namen die komplette CUID angezeigt (z.B. `cmkcybla5000113ynm943eyb5`)
  - Das ist unn√∂tige technische Information f√ºr Admins und reduziert die Lesbarkeit
  - L√∂sung: Die ID-Zeile unter dem Namen entfernt in `src/app/(app)/admin/users/users-list.tsx`
  - User werden bereits durch Name + Email + Rolle eindeutig identifiziert
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-15)
- **UX: cursor-pointer zu allen klickbaren Elementen hinzugef√ºgt**
  - Problem: HTML `<button>` Elemente haben standardm√§√üig `cursor: default`, nicht `cursor: pointer`
  - User erwarten bei klickbaren Elementen einen Zeiger-Cursor - das ist Standard-UX
  - L√∂sung: `cursor-pointer` an 3 Stellen hinzugef√ºgt:
    - `src/components/ui/button.tsx` - Button-Komponente Basis-Styles (betrifft alle ~50+ Button-Nutzungen)
    - `src/components/ui/sortable-table-header.tsx` - Sortierbare Tabellen-Header
    - `src/components/dashboard/issue-search.tsx` - Suchergebnis-Buttons
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-15)
- **UX: Header-Buttons mit Tooltips versehen**
  - Problem: Theme-Toggle und Logout-Button im Header hatten nur Icons ohne visuelle Erkl√§rung
  - User mussten raten, was die Buttons tun - schlechte UX f√ºr Icon-only Buttons
  - L√∂sung: Radix UI Tooltips zu beiden Buttons hinzugef√ºgt
    - Theme-Toggle: Zeigt "Light mode" oder "Dark mode" je nach aktuellem Zustand
    - Logout-Button: Zeigt "Sign out"
  - Konsistent mit issue-detail.tsx, wo Tooltips bereits f√ºr Font-Size-Buttons verwendet werden
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-14)
- **UX: Dashboard StatCards klickbar gemacht**
  - Problem: StatCards auf dem Dashboard zeigten Statistiken (z.B. "5 Open Issues"), waren aber nicht klickbar
  - User erwarten, dass Klick auf "Open Issues" zu den gefilterten Issues f√ºhrt
  - L√∂sung:
    - `StatCard` Komponente erweitert mit optionaler `href` prop
    - Bei Angabe von `href` wird die Card in einen Link gewrapped
    - Hover-Effekt (shadow) f√ºr visuelle Feedback
  - Dashboard-Verlinkungen:
    - "Open Issues" ‚Üí `/issues` (default zeigt new + in_progress)
    - "In Progress" ‚Üí `/issues?status=in_progress`
    - "Due This Week" ‚Üí `/issues`
    - "Active Projects" ‚Üí `/projects` (default zeigt active)
  - Issues-Seite erweitert:
    - Akzeptiert `status` URL-Parameter (comma-separated m√∂glich)
    - `IssuesList` erh√§lt `initialStatuses` prop f√ºr URL-gesteuerte Filter
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-14)
- **UX: Sidebar Admin Icon korrigiert**
  - Problem: "Users" Men√ºpunkt im Admin-Bereich verwendete `Settings`-Icon (‚öôÔ∏è)
  - Das war semantisch falsch - Settings-Icon suggeriert Einstellungen, nicht Benutzerverwaltung
  - L√∂sung: `Settings` durch `Users` Icon ersetzt (üë•)
  - Konsistenter mit der Funktion des Men√ºpunkts
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-14)
- **Bug Fix: Hydration Mismatch in Issue Detail View**
  - Problem: `useFontSizeStorage` und `useSidebarVisibility` Hooks verursachten Hydration Errors
  - Ursache: `useState` Initializer verwendete `typeof window !== 'undefined'` Check
  - Server renderte mit Default-Werten, Client las aus localStorage ‚Üí Mismatch
  - L√∂sung: Refactoring zu `useSyncExternalStore` (React 18+ Pattern)
    - `getServerSnapshot` f√ºr konsistenten Server-Render
    - `getSnapshot` f√ºr Client mit localStorage-Zugriff
    - StorageEvent dispatch f√ºr Re-Render bei √Ñnderungen
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

- **UX: UI-Texte auf Englisch vereinheitlicht**
  - Problem: Deutsche Labels in ansonsten englischer UI
  - Ge√§ndert: "Schrift verkleinern/vergr√∂√üern" ‚Üí "Decrease/Increase font size"
  - Ge√§ndert: "Seitenleiste ein-/ausblenden" ‚Üí "Show/Hide sidebar"
  - Ge√§ndert: Font-Size Labels "Klein/Normal/Gro√ü/Sehr gro√ü" ‚Üí "Small/Normal/Large/Extra large"

  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-14)
- **UX: Comment Ownership aus echter Session**
  - Problem: `/issues/[id]/page.tsx` verwendete `issue.author.id` als `currentUserId`
  - Das war ein Workaround-Kommentar: "For now, use the first user as current user"
  - Folge: Delete-Button f√ºr Kommentare wurde falsch berechnet:
    - User A erstellt Issue, User B schreibt Kommentar
    - User A sah f√§lschlich Delete-Button f√ºr User B's Kommentar
    - User B sah seinen eigenen Delete-Button nicht
  - L√∂sung: `getSession()` wird jetzt parallel geladen, `session?.id` f√ºr Ownership
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**
   
  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-14)
- **UX: Issues-Liste zeigt standardm√§√üig nur offene Issues**
  - Problem: Issues-Liste hatte keinen Default-Filter, zeigte ALLE Issues (inkl. closed/rejected)
  - User musste manuell filtern, um aktuelle Issues zu sehen
  - Inkonsistent mit Projekte-Liste (die hat Default-Filter auf "active")
  - L√∂sung: Default-Status-Filter auf `['new', 'in_progress']` gesetzt
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-13)
- **UX: Unn√∂tiges Dropdown im Sidebar-Footer entfernt**
  - Problem: User-Bereich im Sidebar-Footer hatte ein Dropdown mit nur einer Aktion (Logout)
  - User musste 2x klicken: 1. Dropdown √∂ffnen, 2. Logout w√§hlen
  - Header hat bereits einen Logout-Button, also Redundanz
  - L√∂sung: Dropdown komplett entfernt, User-Info wird statisch angezeigt
  - Entfernt: `DropdownMenu*` Imports, `ChevronDown`, `LogOut`, `logout` Action
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**
  
  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-13)
- **UX: Fake Notifications-Button aus Header entfernt**
  - Problem: Header zeigte Bell-Icon mit rotem Notification-Dot
  - Aber es gibt KEIN Notifications-System - Button war funktionslos
  - User w√ºrden draufklicken und nichts passiert - schlechte UX
  - L√∂sung: Bell-Button + Dot komplett entfernt (analog zu vorherigen Dropdown-Cleanups)
  - Ungenutzten `Bell` Import entfernt
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**
  
  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-13)
- **UX: Deaktivierte Dropdown-Men√ºpunkte entfernt**
  - Problem: User-Dropdown im Sidebar-Footer hatte `disabled` "Profile" und "Settings" Items
  - Diese zeigten Funktionen, die nicht existieren - schlechte UX
  - L√∂sung: Deaktivierte Items und Separator entfernt
  - Ungenutzten `DropdownMenuSeparator` Import entfernt
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**
  
  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-13)
- **UX: Sidebar Logout Button funktional gemacht**
  - Problem: User-Dropdown im Sidebar-Footer hatte `disabled` Log out
  - Header hatte bereits funktionierenden Logout, Sidebar nicht
  - L√∂sung: Sidebar Dropdown-MenuItem zu funktionalem Form/Button umgebaut
  - Nutzt bestehende `logout` Server Action
  - LogOut Icon hinzugef√ºgt f√ºr Konsistenz
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**
  
  **N√§chste Schritte:**
  - PRD-Task: Weitere UX-Verbesserungen oder Administration (Settings)

## Vorherige Iteration (2026-01-13)
- **Auth: UI Rollen-Berechtigungen implementiert**
  - Neuer `SessionContext` mit `SessionProvider` und `useSession()` Hook
  - Session-Daten (id, email, name, role) vom Server-Layout an Client-Komponenten weitergegeben
  - **UI-√Ñnderungen:**
    - Sidebar: Admin-Bereich nur f√ºr Admins sichtbar
    - Sidebar: User-Name/Email aus echter Session statt hardcoded
    - Projects-List: "New Project" Button nur f√ºr Admin/Manager
    - Project-Detail: Settings/Delete Buttons nur f√ºr Admin/Manager
    - Quick-Actions: "New Project" nur f√ºr Admin/Manager
  - **Route Protection:**
    - Neues `/admin/layout.tsx` pr√ºft Admin-Rolle serverseitig
    - Non-Admins werden zu `/` redirected
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**
  
  **N√§chste Schritte:**
  - PRD-Task: "UX verbessern" oder "Administration (Settings) Implementieren"

## Vorherige Iteration (2026-01-13)
- **Lint Fix: sonner.tsx refaktoriert (useSyncExternalStore)**
  - ESLint 'react-hooks/set-state-in-effect' Regel flaggte setState in useEffect
  - L√∂sung: `useSyncExternalStore` (React 18+ Pattern) f√ºr Theme-Erkennung
  - `mounted` State-Workaround entfernt - useSyncExternalStore handled SSR/Hydration
  - 16 Zeilen hinzugef√ºgt, 18 entfernt (netto: -2 Zeilen)
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-13)
- **Auth: Server Actions abgesichert**
  - **Issues Actions (`src/app/actions/issues.ts`):**
    - `createIssue`: requireAuth(), authorId aus Session
    - `updateIssue`: requireAuth()
    - `deleteIssue`: requireAuth()
    - `bulkUpdateIssues`: requireAuth()
  - **Users Actions (`src/app/actions/users.ts`):**
    - `createUser`, `updateUser`, `deleteUser`: requireRole(['admin'])
  - **Projects Actions (`src/app/actions/projects.ts`):**
    - `createProject`, `updateProject`, `deleteProject`: requireRole(['admin', 'manager'])
  - **Comments Actions (`src/app/actions/comments.ts`):**
    - `createComment`: requireAuth(), authorId aus Session
    - `updateComment`: requireAuth() + Ownership-Check
    - `deleteComment`: requireAuth() + Ownership-Check (oder Admin)
  - **Time Entries Actions (`src/app/actions/time-entries.ts`):**
    - `createTimeEntry`: requireAuth(), userId aus Session
    - `deleteTimeEntry`: requireAuth() + Ownership-Check (oder Admin)
  - **Database Actions (`src/app/actions/database.ts`):**
    - `importDatabase`: requireRole(['admin'])
  - **Refactoring:**
    - `currentUserId` Parameter aus Forms entfernt (4 Dateien)
    - Server holt User-ID jetzt direkt aus Session
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**
  
  **N√§chste Schritte:**
  - UI-Elemente basierend auf Session-Role ein-/ausblenden (z.B. Admin-Bereich nur f√ºr Admins)

## Vorherige Iteration (2026-01-13)
- **Dokumentation bereinigt: PRD + notes.txt synchronisiert**
  - PRD aktualisiert: Erledigte Tasks dokumentiert (Test Coverage, Bug Hunt, DRY, Design, Dokumentation)
  - notes.txt bereinigt: Redundante Sektionen entfernt
    - "PRD-Tasks Status" Checkliste entfernt (jetzt in PRD "Erledigt")
    - "N√§chste Schritte" entfernt (jetzt in PRD "Offen")
    - Erledigte Strikethrough-Items entfernt
  - Coverage-Zahl korrigiert: 98.61% ‚Üí 98.69% (aktueller Wert)
  - ~60 Zeilen Redundanz entfernt
  - **213 Tests gr√ºn, Lint clean**

## Vorherige Iteration (2026-01-13)
- **DRY: StatCard Komponenten konsolidiert**
  - Problem: Zwei verschiedene `StatCard` Komponenten mit unterschiedlichen APIs:
    - `src/components/ui/stat-card.tsx` (label, progress)
    - `src/components/dashboard/stat-card.tsx` (title, variant, trend, subtitle)
  - L√∂sung: Eine einheitliche Komponente in `ui/stat-card.tsx` mit allen Features:
    - Unterst√ºtzt `label` UND `title` (backwards compatible)
    - Unterst√ºtzt `progress`, `variant`, `trend`, `subtitle`
    - Automatische Styling-Anpassung basierend auf verwendeten Props
  - `dashboard/stat-card.tsx` gel√∂scht, Export aus `index.ts` entfernt
  - `page.tsx` Import aktualisiert auf `ui/stat-card`
  - **~50 Zeilen duplizierter Code entfernt** (94 Zeilen ‚Üí 0, konsolidiert in 120 Zeilen)
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-13)
- **DRY: SortableTableHeader Komponente erstellt**
  - Neue wiederverwendbare Komponente: `src/components/ui/sortable-table-header.tsx`
  - Props: field, label, currentField, direction, onSort, align (optional), className (optional)
  - 10 identische Button+SortIcon Patterns in 3 Dateien konsolidiert:
    - `src/app/issues/issues-list.tsx` (4 sortable headers)
    - `src/app/admin/users/users-list.tsx` (4 sortable headers)
    - `src/app/time/time-list.tsx` (2 sortable headers)
  - **~50 Zeilen duplizierter Code entfernt** (7 Zeilen √ó 10 ‚Üí 40 Zeilen Komponente + 10 √ó 1 Zeile Aufrufe)
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-13)
- **Lint Fix: Unused Imports in e2e/seed.spec.ts entfernt**
  - `expect` Import und `page` Parameter waren ungenutzt
  - 2 Lint-Warnings behoben
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-13)
- **DRY: StatCard Komponente erstellt (sp√§ter konsolidiert)**
  - Wurde sp√§ter mit dashboard/stat-card zusammengef√ºhrt (siehe oben)

## Vorherige Iteration (2026-01-13)
- **Test Coverage: utils.ts von 18.75% auf 100% erh√∂ht**
  - Neue Testdatei: `src/lib/utils.test.ts` mit 22 Tests
  - Getestete Funktionen: `cn`, `getInitials`, `formatDate`, `generateId`, `formatShortId`, `staggerDelay`
  - Coverage gesamt: **98.69%** (vorher 94.44%)
  - **213 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-13)
- **DRY: FilterDropdown Komponente erstellt**
  - Neue wiederverwendbare Komponente: `src/components/ui/filter-dropdown.tsx`
  - Generisch typisiert f√ºr verschiedene Filter-Typen (Status, Tracker, Priority, etc.)
  - Props: label, menuLabel, icon, options, selected, onToggle, width
  - 4 identische Dropdown-Strukturen konsolidiert:
    - `src/app/issues/issues-list.tsx` (3 Dropdowns: Status, Tracker, Priority)
    - `src/app/projects/projects-list.tsx` (1 Dropdown: Status)
  - **~71 Zeilen netto entfernt** (141 entfernt, 70 hinzugef√ºgt)
  - **191 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-13)
- **Lint Cleanup: 3 Unused Import/Variable Warnings behoben**
  - `src/app/issues/[id]/issue-detail.tsx`:
    - Entfernt: `getFullName`, `priorityLabels` (ungenutzte Imports)
    - Entfernt: `priority` Variable (nicht verwendet)
  - `src/app/issues/[id]/issue-sidebar.tsx`:
    - Entfernt: `formatShortId` (ungenutzter Import)
  - **191 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-12)
- **DRY: Badge Color Constants zentralisiert**
  - Neue Exports in `src/types/index.ts`:
    - `projectStatusColors: Record<ProjectStatus, string>` (Tailwind-Klassen f√ºr active/archived/closed)
    - `roleColors: Record<UserRole, string>` (Tailwind-Klassen f√ºr admin/manager/developer/reporter)
  - 2 lokale Duplikate entfernt:
    - `src/app/projects/projects-list.tsx` (statusColors ‚Üí projectStatusColors)
    - `src/app/projects/[identifier]/project-detail.tsx` (projectStatusColors entfernt)
  - 1 weiteres Duplikat entfernt:
    - `src/app/admin/users/users-list.tsx` (roleColors)
  - ~18 Zeilen duplizierter Code entfernt
  - **191 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-12)
- **DRY: generateId() Utility zentralisiert**
  - Neue Funktion in `src/lib/utils.ts`: `generateId(prefix: string): string`
  - Pattern: `{prefix}-{timestamp}-{random7chars}`
  - 4 lokale Duplikate entfernt aus:
    - `src/lib/issue-form.ts`
    - `src/lib/user-form.ts`
    - `src/lib/project-form.ts`
    - `src/lib/time-entry-form.ts`
  - ~12 Zeilen Code reduziert (4x inline ‚Üí 1 zentrale Funktion)
  - **191 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-12)
- **Bug Hunt: Umfassende Codebase-Analyse durchgef√ºhrt**
  - **Ergebnis: Keine kritischen Bugs gefunden!**
  - Gepr√ºfte Kategorien:
    - ‚úÖ Leere catch-Bl√∂cke (1 Fund - absichtlich f√ºr Theme-Script FOUC-Prevention)
    - ‚úÖ TypeScript Hacks (keine `as any`, `@ts-ignore`)
    - ‚úÖ XSS-Schwachstellen (react-markdown ist sicher by default)
    - ‚úÖ Race Conditions (korrekte State-Updates nach Server-Response)
    - ‚úÖ Unbehandelte Null-Returns (alle Pages mit `notFound()`)
    - ‚úÖ Input Validierung (alle Server Actions validiert)
    - ‚úÖ Array Boundaries (alle mit Fallbacks)
    - ‚úÖ Double Submit Prevention (alle Forms mit `isSubmitting`)
    - ‚úÖ Date Handling (korrekte ISO-String Konvertierung)
    - ‚úÖ Filter/Sort-Logik (robuste null-Checks, Array-Support)
  - **Bekannte Limitation:** Server Actions haben keine Authorization-Checks
    - Dies ist KEIN Bug, da Auth-System noch nicht implementiert ist
    - Frontend-only Authorization (UI versteckt Buttons) ist Platzhalter
  - **191 Tests gr√ºn, 98.61% Coverage, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-12)
- **Bug Fix + DRY: isOverdue() Funktion konsolidiert**
  - **Bug gefunden:** Zentrale `isOverdue()` ignorierte `resolved` Status
    - Ein Issue mit Status `resolved` und vergangenem Due Date wurde f√§lschlich als "overdue" markiert
  - **L√∂sung:**
    - `src/types/index.ts`: `resolved` zu completedStatuses hinzugef√ºgt
    - Signatur generisch gemacht: `{ status: string; dueDate: Date | string | null }`
  - **DRY:** 2 lokale Duplikate entfernt:
    - `src/app/issues/[id]/issue-detail.tsx` (lokale isOverdue Funktion ~5 Zeilen)
    - `src/components/dashboard/issues-table.tsx` (lokale isOverdue Funktion ~4 Zeilen)
  - Tests erweitert: 2 neue Tests (resolved Status, String-Datum Handling)
  - **191 Tests gr√ºn, Lint clean, Build erfolgreich**

## Vorherige Iteration (2026-01-12)
- **Bug Hunt: Delete Handler Error Handling verbessert**
  - Problem: `else if ('error' in result)` lie√ü unerwartete F√§lle ohne Feedback
  - L√∂sung: `else` mit Fallback-Fehlermeldung (`'error' in result ? result.error : 'Fallback'`)
  - 4 Dateien gefixt:
    - `src/app/issues/[id]/issue-detail.tsx` (handleDelete)
    - `src/app/issues/[id]/comments.tsx` (handleDelete)
    - `src/app/projects/[identifier]/project-detail.tsx` (handleDelete)
    - `src/app/admin/users/users-list.tsx` (handleDelete)
  - Vorher: Bei unerwarteten Server-Responses blieb Button ggf. im "Deleting..." Zustand
  - Nachher: Immer ein Error-Toast + State-Reset bei Fehler

## Vorherige Iteration (2026-01-12)
- **DRY: filterProjects generisch gemacht**
  - `src/lib/projects.ts`: Funktion jetzt generisch mit TypeScript Generics
  - `FilterableProject` Interface f√ºr strukturelles Typing
  - Unterst√ºtzt sowohl `Project` als auch `SerializedProject` Types
  - Lokale Duplikat-Funktion aus `src/app/projects/projects-list.tsx` entfernt (~25 Zeilen)
  - Keine Breaking Changes - bestehende Tests weiterhin gr√ºn

## Vorherige Iteration (2026-01-12)
- **DRY: Konstanten und GeneralFormError konsolidiert**
  - `EMAIL_REGEX` aus `src/lib/user-form.ts` exportiert und in 4 Dateien importiert
    - `src/app/actions/users.ts`
    - `src/app/admin/users/new/user-form.tsx`
    - `src/app/admin/users/[id]/edit/user-edit-form.tsx`
  - `GeneralFormError` Komponente in `src/components/ui/form-field-error.tsx` hinzugef√ºgt
    - Ersetzt 5 identische `{errors.general && ...}` Bl√∂cke
    - Mit `className` prop f√ºr kontextspezifisches Styling
  - `ActivityType` zentralisiert in `src/types/index.ts`:
    - Neuer Type: `ActivityType`
    - Neues Label-Record: `activityTypeLabels`
    - Neues Array: `allActivityTypes`
    - Neue Options: `activityTypeOptions`
    - `TimeEntry.activityType` jetzt typisiert statt `string`
  - Lokale Duplikate entfernt aus:
    - `src/app/time/new/time-entry-form.tsx` (activityTypes Array)
    - `src/app/time/time-list.tsx` (activityLabels, allActivities)

## Vorherige Iteration (2026-01-12)
- **DRY: FormFieldError Komponente erstellt**
  - Neue UI-Komponente in `src/components/ui/form-field-error.tsx`
  - Kapselt das wiederkehrende Pattern: `{error && <p><AlertCircle/>{error}</p>}`
  - 7 Form-Komponenten refaktoriert:
    - `src/app/admin/users/new/user-form.tsx` (4 Stellen)
    - `src/app/admin/users/[id]/edit/user-edit-form.tsx` (4 Stellen)
    - `src/app/issues/new/issue-form.tsx` (3 Stellen)
    - `src/app/issues/[id]/edit/issue-edit-form.tsx` (3 Stellen)
    - `src/app/time/new/time-entry-form.tsx` (4 Stellen)
    - `src/app/projects/new/project-form.tsx` (3 Stellen)
    - `src/app/projects/[identifier]/edit/project-edit-form.tsx` (3 Stellen)
  - **24 identische JSX-Bl√∂cke ‚Üí 1 wiederverwendbare Komponente**
  - ~120 Zeilen duplizierter Code entfernt (5 Zeilen √ó 24 = 120, Ersatz: 18 Zeilen)
  - Guard-Clause (`if (!error) return null`) vereinfacht Consumer-Code

## Vorherige Iteration (2026-01-12)
- **DRY: useFormField() Custom Hook erstellt**
  - Neuer Hook in `src/hooks/useFormField.ts` - kapselt das Pattern "Update Field + Clear Error"
  - 5 Form-Komponenten refaktoriert:
    - `src/app/admin/users/new/user-form.tsx`
    - `src/app/admin/users/[id]/edit/user-edit-form.tsx`
    - `src/app/issues/new/issue-form.tsx`
    - `src/app/issues/[id]/edit/issue-edit-form.tsx`
    - `src/app/time/new/time-entry-form.tsx`
  - 2 Projekt-Forms bewusst ausgelassen (haben spezielle Logik: Auto-Generate Identifier)
  - ~60 Zeilen duplizierter Code entfernt
  - TypeScript Generics f√ºr Type Safety

## Vorherige Iteration (2026-01-12)
- **DRY: getFullName() konsistent genutzt**
  - 7 Stellen mit direkter `{firstName} {lastName}` Konkatenation durch `getFullName()` ersetzt
  - Dateien:
    - `src/app/issues/new/issue-form.tsx`
    - `src/app/issues/[id]/edit/issue-edit-form.tsx`
    - `src/app/issues/[id]/issue-detail.tsx` (2 Stellen: assignee + author)
    - `src/app/issues/[id]/comments.tsx`
    - `src/app/issues/issues-list.tsx`
    - `src/app/projects/[identifier]/project-detail.tsx`
  - Vorteile: Single Source of Truth, einfacher Format-√Ñnderung, Type Safety

## Vorherige Iteration (2026-01-12)
- **DRY: Form Options zentralisiert**
  - `trackerOptions`, `priorityOptions`, `projectStatusOptions` in `src/types/index.ts`
  - Aus Labels abgeleitet (Single Source of Truth)
  - 4 lokale Duplikate entfernt aus:
    - `src/app/issues/new/issue-form.tsx`
    - `src/app/issues/[id]/edit/issue-edit-form.tsx`
    - `src/app/projects/new/project-form.tsx`
    - `src/app/projects/[identifier]/edit/project-edit-form.tsx`
  - ~42 Zeilen duplizierter Code entfernt
  - Types (`IssueTracker`, `IssuePriority`, `ProjectStatus`) werden nun zentral importiert

## Vorherige Iteration (2026-01-12)
- **DRY: getFullName() generisch gemacht**
  - Zentrale Funktion in `src/types/index.ts` nun mit `{ firstName: string; lastName: string }` statt `User`
  - 3 lokale Duplikate entfernt aus:
    - `src/app/time/time-list.tsx`
    - `src/app/admin/users/users-list.tsx`
    - `src/components/dashboard/issues-table.tsx`
  - ~12 Zeilen Code entfernt, TypeScript Structural Typing erm√∂glicht Kompatibilit√§t

## Vorherige Iteration (2026-01-12)
- **UX-Bugs behoben:**
  - Reports-Link aus Quick Actions entfernt (f√ºhrte zu 404 - `/reports` existiert nicht)
  - "New Issue" Button in Sidebar verlinkt (war zuvor nicht klickbar)
  - Hardcoded "Recent Projects" aus Sidebar entfernt (zeigte fake Projekte die nicht existieren)

## Vorherige Iterationen
- **DRY: Server Action Error Handler zentralisiert** (14 catch-Bl√∂cke, ~70 -> ~25 Zeilen)
- **DRY: formatDate() Utility zentralisiert** (7 Dateien, ~40 Zeilen)
- **DRY: TrackerIcon Komponente zentralisiert** (2 Dateien)
- **DRY: Ungenutzte SortDirection Re-Exports entfernt** (4 lib Dateien)
- **DRY: SortDirection in time-list.tsx** (lokale Definition entfernt)
- **DRY: Enum-Arrays zentralisiert** (`allIssueStatuses`, etc. in types/index.ts)
- **DRY: `SortIcon` Komponente zentralisiert** (3 Dateien, ~30 Zeilen)
- **DRY: `getInitials()` zentralisiert** (7 Dateien, ~50 Zeilen)
- **DRY: Label-Konstanten zentralisiert** (statusLabels, trackerLabels, etc.)
- **Markdown Rendering:** Issue-Beschreibungen und Kommentare
- **Performance:** `issues-list.tsx` - `toIssue()` Mapping in separates `useMemo`
- **Dark Mode:** System-Pr√§ferenz + Persistenz
- **Lesbarkeit/DRY:** toggle-Funktionen konsolidiert
- README.md projektspezifisch aktualisiert
- Test Coverage: **98.69%** (weit √ºber Ziel 35%)

## Bekannte TODOs im Code
- `src/app/time/new/time-entry-form.tsx:106` - Get actual user ID from auth context
- `src/app/issues/new/issue-form.tsx:119` - Get from auth context
(Diese sind architekturelle Platzhalter f√ºr Auth-System, kein Bug)

## Weitere DRY-Kandidaten (identifiziert, noch nicht umgesetzt)
- Server Action revalidatePath: Wiederholende Calls (geringer Nutzen)
- Unique-Check Functions: `isIdentifierTaken` / `isEmailTaken` √§hnlich (nur 2 Stellen, unter 3er-Schwelle)
- `roleOptions` mit Icons: 2 Dateien (user-form, user-edit-form) - Icons sind UI-spezifisch, daher nicht in types/
- `SerializedUser/Project/Issue` Types: Viele √§hnliche Definitionen (je ~3-8 Felder unterschiedlich pro Kontext)

---
Letzte Aktualisierung: 2026-01-13 (PRD aktualisiert, redundante Sektionen bereinigt)
